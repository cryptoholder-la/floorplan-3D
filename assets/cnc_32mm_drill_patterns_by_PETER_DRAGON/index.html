<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CNC 32mm Drill Patterns</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <link rel="stylesheet" href="./styles.css" />
  <!-- Tailwind & fonts from new UI -->
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link crossorigin href="https://fonts.gstatic.com" rel="preconnect" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#137fec",
            "background-light": "#f6f7f8",
            "background-dark": "#101922",
          },
          fontFamily: {
            display: ["Inter", "sans-serif"],
          },
          borderRadius: { DEFAULT: "0.25rem", lg: "0.5rem", xl: "0.75rem", full: "9999px" },
        },
      },
    };
  </script>
  <style>
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  <script type="importmap">
  {
    "imports": {
      "nanoid": "https://esm.sh/nanoid@5.0.7"
    }
  }
  </script>
</head>
<body class="bg-background-light dark:bg-background-dark font-display">
  <div class="relative flex min-h-screen w-full flex-col overflow-x-hidden">
    <!-- Top App Bar -->
    <header class="sticky top-0 z-10 flex h-16 items-center border-b border-white/10 bg-background-light dark:bg-background-dark bg-opacity-80 backdrop-blur-sm px-4">
      <button class="text-gray-900 dark:text-white mr-2">
        <span class="material-symbols-outlined text-3xl">menu</span>
      </button>
      <h1 class="flex-1 text-xl font-bold text-gray-900 dark:text-white">Drill Pattern Configurator</h1>
      <button class="text-gray-900 dark:text-white ml-2">
        <span class="material-symbols-outlined text-3xl">account_circle</span>
      </button>
    </header>

    <main class="flex-1 px-4 py-6 pb-28">
      <!-- Configuration Section -->
      <section class="mb-8">
        <h2 class="text-lg font-bold leading-tight tracking-tight text-gray-900 dark:text-white mb-4">
          Part &amp; Hardware Selection
        </h2>
        <div class="space-y-4">
          <!-- Part type (wired to existing logic) -->
          <label class="flex flex-col">
            <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Part Type</p>
            <select
              id="partType"
              class="form-select flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-14 p-3.5 text-base font-normal leading-normal appearance-none bg-no-repeat bg-right"
              style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBRgXP5mjSI_uDt0YXJeEPKisKd853B22ctVDxk0O8zEw99bMPFIUyot3qClQV9yIW4FZbi1bxZ4agjfYrwkafujww816x4jMrkDZIpvstI02zRXAi799vDYzZ4e4lebja3MaVW8aJTCGmzUV57nNlS66jGoIRFf6nlGHtModjDvq5mIZ1q7qmBPCWTcJiJAWTkOLP1jY166FF-UJ-BDID_GSZvnHEWtkcTgfGsXvDLzdBIc8b783l7T-QAFutW4Y2Ra36-Km_nvJ1f');"
            >
              <option value="cabinetSide">Cabinet side</option>
              <option value="door">Door</option>
              <option value="drawerFront">Drawer front</option>
              <option value="cabinetTopBottom">Cabinet top / bottom</option>
              <option value="fixedShelf">Fixed shelf</option>
              <option value="adjustableShelf">Adjustable shelf</option>
              <option value="backPanel">Back panel</option>
              <option value="nailerStrip">Top / bottom nailer strip</option>
            </select>
          </label>

          <!-- Cabinet part presets for quick part viewing -->
          <div class="grid grid-cols-2 gap-3">
            <label class="flex flex-col">
              <p class="text-xs font-medium text-gray-700 dark:text-gray-300 pb-1">Cabinet preset</p>
              <select
                id="cabinetPreset"
                class="form-select w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-11 p-2.5 text-xs"
              >
                <option value="">Custom part</option>
                <!-- options injected via JS -->
              </select>
            </label>
            <label class="flex flex-col">
              <p class="text-xs font-medium text-gray-700 dark:text-gray-300 pb-1">Cabinet part</p>
              <select
                id="cabinetPartRole"
                class="form-select w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-11 p-2.5 text-xs"
              >
                <option value="">Select part</option>
                <!-- options injected via JS -->
              </select>
            </label>
          </div>

          <!-- Hardware type (wired to existing logic) -->
          <label class="flex flex-col">
            <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Hardware Type</p>
            <select
              id="hardwareType"
              class="form-select flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-14 p-3.5 text-base font-normal leading-normal appearance-none bg-no-repeat bg-right"
              style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBRgXP5mjSI_uDt0YXJeEPKisKd853B22ctVDxk0O8zEw99bMPFIUyot3qClQV9yIW4FZbi1bxZ4agjfYrwkafujww816x4jMrkDZIpvstI02zRXAi799vDYzZ4e4lebja3MaVW8aJTCGmzUV57nNlS66jGoIRFf6nlGHtModjDvq5mIZ1q7qmBPCWTcJiJAWTkOLP1jY166FF-UJ-BDID_GSZvnHEWtkcTgfGsXvDLzdBIc8b783l7T-QAFutW4Y2Ra36-Km_nvJ1f');"
            >
              <option value="blum_cliptop_hinge_100">Blum ClipTop 110° hinge</option>
              <option value="blum_cliptop_hinge_155">Blum ClipTop 155° hinge</option>
              <option value="blum_tandem_box">Blum TANDEM drawer slide</option>
              <option value="blum_movento">Blum MOVENTO drawer slide</option>
              <option value="system32_row">32mm shelf row</option>
              <option value="dowel_side_joints">Side dowel joints (front/back)</option>
              <option value="back_panel_nailer">Back panel + nailer dowels</option>
              <option value="hettich_sensys_8645_110">Hettich Sensys 8645 110° hinge</option>
              <option value="hettich_innotech_atira">Hettich InnoTech Atira drawer slide</option>
              <option value="hafele_hinge_110">Häfele 110° concealed hinge</option>
              <option value="grass_tiomos_110">Grass Tiomos 110° hinge</option>
              <option value="salice_silentia_110">Salice Silentia 110° hinge</option>
            </select>
          </label>

          <!-- Origin & face & row spacing (from original UI) -->
          <div class="grid grid-cols-3 gap-4 pt-2">
            <label class="flex flex-col">
              <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Reference corner</p>
              <select
                id="origin"
                class="form-select w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-12 p-2.5 text-sm"
              >
                <option value="bottomLeft">Bottom-left</option>
                <option value="bottomRight">Bottom-right</option>
                <option value="topLeft">Top-left</option>
                <option value="topRight">Top-right</option>
              </select>
            </label>
            <label class="flex flex-col">
              <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Face</p>
              <select
                id="face"
                class="form-select w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-12 p-2.5 text-sm"
              >
                <option value="front">Front</option>
                <option value="back">Back</option>
              </select>
            </label>
            <label class="flex flex-col">
              <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Row spacing</p>
              <select
                id="rowConfig"
                class="form-select w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-12 p-2.5 text-sm"
              >
                <option value="single">Single row</option>
                <option value="double">Double row</option>
              </select>
            </label>
          </div>
        </div>
      </section>

      <!-- Dimensions Section -->
      <section class="mb-8">
        <h2 class="text-lg font-bold leading-tight tracking-tight text-gray-900 dark:text-white mb-4">
          Enter Dimensions
        </h2>
        <div class="grid grid-cols-3 gap-4">
          <label class="flex flex-col">
            <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Length</p>
            <div class="relative">
              <input
                id="length"
                type="number"
                value="720"
                class="form-input w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-14 p-3.5 pr-12 text-base font-normal"
              />
              <span class="absolute inset-y-0 right-0 flex items-center pr-3 text-sm text-gray-500">mm</span>
            </div>
          </label>
          <label class="flex flex-col">
            <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Width</p>
            <div class="relative">
              <input
                id="width"
                type="number"
                value="300"
                class="form-input w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-14 p-3.5 pr-12 text-base font-normal"
              />
              <span class="absolute inset-y-0 right-0 flex items-center pr-3 text-sm text-gray-500">mm</span>
            </div>
          </label>
          <label class="flex flex-col">
            <p class="text-sm font-medium text-gray-700 dark:text-gray-300 pb-2">Thickness</p>
            <div class="relative">
              <input
                id="thickness"
                type="number"
                value="18"
                class="form-input w-full rounded-lg bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary focus:border-primary h-14 p-3.5 pr-12 text-base font-normal"
              />
              <span class="absolute inset-y-0 right-0 flex items-center pr-3 text-sm text-gray-500">mm</span>
            </div>
          </label>
        </div>
      </section>

      <!-- Preview Section -->
      <section class="mb-6">
        <h2 class="text-lg font-bold leading-tight tracking-tight text-gray-900 dark:text-white mb-4">
          Pattern Preview
        </h2>
        <div class="relative aspect-[4/3] w-full rounded-xl bg-gray-200 dark:bg-gray-800 flex items-center justify-center p-4">
          <!-- Existing SVG preview hooked into app logic -->
          <svg id="previewSvg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" class="w-full h-full"></svg>

          <!-- Overlays (static info, will still look good as preview changes) -->
          <div class="absolute bottom-3 right-3 flex items-center gap-2 rounded-full bg-black/30 px-3 py-1.5 text-white backdrop-blur-sm">
            <span class="material-symbols-outlined text-xl">pinch_zoom_in</span>
            <span class="material-symbols-outlined text-xl">360</span>
          </div>
        </div>
      </section>

      <!-- Holes table + AI panel (from original UI) -->
      <section class="mb-4">
        <div class="rounded-xl border border-white/10 bg-gray-100/80 dark:bg-gray-900/80 px-3 py-3 space-y-3">
          <div class="flex items-center justify-between text-xs text-gray-600 dark:text-gray-300">
            <span class="font-semibold">Holes (mm)</span>
            <div class="flex gap-2">
              <button id="aiHelperBtn" class="px-3 py-1 rounded-full text-xs bg-gray-800 text-gray-200">
                AI CNC help
              </button>
              <button id="copyJsonBtn" class="px-3 py-1 rounded-full text-xs bg-primary/10 text-primary">
                Copy JSON
              </button>
            </div>
          </div>
          <div class="max-h-40 rounded-lg overflow-hidden bg-gray-200/60 dark:bg-gray-950/60">
            <table class="w-full text-[11px]">
              <thead class="bg-gray-300/80 dark:bg-gray-800/80">
                <tr>
                  <th class="px-2 py-1 text-left">#</th>
                  <th class="px-2 py-1 text-right">X</th>
                  <th class="px-2 py-1 text-right">Y</th>
                  <th class="px-2 py-1 text-right">Ø</th>
                  <th class="px-2 py-1 text-right">Depth</th>
                </tr>
              </thead>
              <tbody id="holesBody" class="block max-h-32 overflow-y-auto text-right">
                <!-- rows injected by JS -->
              </tbody>
            </table>
          </div>
          <div class="rounded-lg border border-white/10 bg-gray-200/60 dark:bg-gray-950/60 px-2 py-2">
            <div class="text-[10px] text-gray-600 dark:text-gray-400 mb-1">SQL + AI notes</div>
            <pre id="aiOutput" class="text-[10px] whitespace-pre-wrap max-h-24 overflow-y-auto text-gray-900 dark:text-gray-100 m-0"></pre>
          </div>
        </div>
      </section>
    </main>

    <!-- Floating Action Button -->
    <div class="fixed bottom-24 right-4 z-20">
      <button class="flex items-center justify-center gap-2 rounded-xl bg-primary px-5 py-4 text-base font-bold text-white shadow-lg hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background-light dark:focus:ring-offset-background-dark">
        <span class="material-symbols-outlined">add</span>
        Add to Nest
      </button>
    </div>

    <!-- Bottom Tab Bar wired to existing view toggles -->
    <nav class="fixed bottom-0 left-0 right-0 z-10 flex h-20 items-center justify-around border-t border-white/10 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm">
      <button id="viewPartBtn" class="flex flex-col items-center gap-1 text-primary">
        <span class="material-symbols-outlined text-3xl" style="font-variation-settings: 'FILL' 1;">view_in_ar</span>
        <span class="text-xs font-bold">Part</span>
      </button>
      <button id="viewNestingBtn" class="flex flex-col items-center gap-1 text-gray-400 dark:text-gray-500">
        <span class="material-symbols-outlined text-3xl">view_quilt</span>
        <span class="text-xs font-medium">Nesting</span>
      </button>
      <button id="viewWorkflowBtn" class="flex flex-col items-center gap-1 text-gray-400 dark:text-gray-500">
        <span class="material-symbols-outlined text-3xl">list_alt</span>
        <span class="text-xs font-medium">Workflow</span>
      </button>
    </nav>
  </div>

  <script type="module" src="./main.js"></script>
</body>
</html>

