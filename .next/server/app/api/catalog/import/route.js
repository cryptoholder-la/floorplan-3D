"use strict";(()=>{var t={};t.id=2942,t.ids=[2942],t.modules={399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3671:(t,e,a)=>{a.r(e),a.d(e,{originalPathname:()=>O,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p});var o={};a.r(o),a.d(o,{POST:()=>u,runtime:()=>s});var r=a(9303),n=a(8716),i=a(670),l=a(7070);(function(){var t=Error("Cannot find module '@/lib/catalog/fs'");throw t.code="MODULE_NOT_FOUND",t})(),function(){var t=Error("Cannot find module '@/lib/catalog/attachments'");throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=Error("Cannot find module '@/lib/catalog/importers'");throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=Error("Cannot find module '@/lib/catalog/merge'");throw t.code="MODULE_NOT_FOUND",t}();let s="nodejs";function c(t){return t.sku?`sku:${t.sku}`:t.id}async function u(t){try{let e=(await t.formData()).getAll("files").filter(t=>t instanceof File);if(0===e.length)return new l.NextResponse('No files uploaded (field name should be "files")',{status:400});let a=await Object(function(){var t=Error("Cannot find module '@/lib/catalog/fs'");throw t.code="MODULE_NOT_FOUND",t}())(),o=[],r=[];for(let t of e){let e=(t.name.split(".").pop()||"").toLowerCase();if("csv"===e){let e=await t.text(),a=Object(function(){var t=Error("Cannot find module '@/lib/catalog/importers'");throw t.code="MODULE_NOT_FOUND",t}())(e);o.push(...Object(function(){var t=Error("Cannot find module '@/lib/catalog/importers'");throw t.code="MODULE_NOT_FOUND",t}())(a));continue}if("json"===e){let e=await t.text(),a=JSON.parse(e);o.push(...Object(function(){var t=Error("Cannot find module '@/lib/catalog/importers'");throw t.code="MODULE_NOT_FOUND",t}())(a));continue}let a=new Uint8Array(await t.arrayBuffer()),n=t.name.replace(/\.[^/.]+$/,""),i=n.split(/[_\-\s]+/)[0]?.toUpperCase(),l={id:i?`sku:${i}`:`name:${n.toLowerCase()}`,sku:i||void 0,name:n,qty:0,cost:0,category:"Catalog",parts:[],attachments:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o.push(l);let s=c(l),u=await Object(function(){var t=Error("Cannot find module '@/lib/catalog/fs'");throw t.code="MODULE_NOT_FOUND",t}())({itemKey:s,fileName:t.name,bytes:a}),d=Object(function(){var t=Error("Cannot find module '@/lib/catalog/attachments'");throw t.code="MODULE_NOT_FOUND",t}())({id:`att:${Date.now()}:${Math.random().toString(16).slice(2)}`,fileName:t.name,relativePath:u.relativePath});r.push({itemKey:s,attachment:d})}let n=Object(function(){var t=Error("Cannot find module '@/lib/catalog/merge'");throw t.code="MODULE_NOT_FOUND",t}())(a.items,o);if(r.length){let t=n.items.map(t=>{let e=c(t),a=r.filter(t=>t.itemKey===e).map(t=>t.attachment);return a.length?{...t,attachments:[...t.attachments||[],...a],updatedAt:new Date().toISOString()}:t});n.items=t}return await Object(function(){var t=Error("Cannot find module '@/lib/catalog/fs'");throw t.code="MODULE_NOT_FOUND",t}())({items:n.items}),l.NextResponse.json({items:n.items,created:n.created,updated:n.updated})}catch(t){return new l.NextResponse(t?.message||"Import failed",{status:500})}}let d=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/catalog/import/route",pathname:"/api/catalog/import",filename:"route",bundlePath:"app/api/catalog/import/route"},resolvedPagePath:"C:\\memlayer-main\\floorplan 3D\\src\\app\\api\\catalog\\import\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:p,serverHooks:f}=d,O="/api/catalog/import/route";function h(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:p})}}};var e=require("../../../../webpack-runtime.js");e.C(t);var a=t=>e(e.s=t),o=e.X(0,[9276,5972],()=>a(3671));module.exports=o})();